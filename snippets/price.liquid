{% comment %}
  Velox Price Component

  Uso:
  {% render 'price', product: product %}
  {% render 'price', product: product, show_compare: true %}

  Muestra el precio con formato, incluyendo precio comparativo si hay descuento.
{% endcomment %}

{% liquid
  assign show_compare_price = show_compare | default: true
  assign current_variant = product.selected_or_first_available_variant

  assign price = current_variant.price
  assign compare_at_price = current_variant.compare_at_price
  assign on_sale = false

  if compare_at_price > price
    assign on_sale = true
  endif
%}

<div class="tw-flex tw-items-center tw-gap-2 tw-flex-wrap">
  {% if on_sale and show_compare_price %}
    <span class="tw-text-accent tw-font-semibold">
      {{ price | money }}
    </span>
    <span class="tw-text-velox-400 tw-line-through tw-text-sm">
      {{ compare_at_price | money }}
    </span>
    {% assign savings = compare_at_price | minus: price %}
    {% assign savings_percent = savings | times: 100.0 | divided_by: compare_at_price | round %}
    <span class="tw-bg-accent tw-text-white tw-text-xs tw-font-semibold tw-px-2 tw-py-0.5 tw-rounded">
      -{{ savings_percent }}%
    </span>
  {% else %}
    <span class="tw-text-velox-900 tw-font-semibold">
      {{ price | money }}
    </span>
  {% endif %}
</div>

{% if product.price_varies %}
  <p class="tw-text-velox-500 tw-text-sm tw-mt-1">
    {{ 'products.product.price.from_price_html' | t: price: product.price_min | money }}
  </p>
{% endif %}
