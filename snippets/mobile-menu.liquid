{% comment %}
  Velox Mobile Menu Drawer
  Menú móvil con navegación accordion.

  Uso:
  {% render 'mobile-menu', menu: 'main-menu' %}
{% endcomment %}

{%- comment -%} Overlay {%- endcomment -%}
<div
  id="mobile-menu-overlay"
  class="tw-fixed tw-inset-0 tw-bg-black/50 tw-z-40 tw-opacity-0 tw-invisible tw-transition-all tw-duration-300"
  data-mobile-menu-overlay
  aria-hidden="true"
></div>

{%- comment -%} Drawer {%- endcomment -%}
<div
  id="mobile-menu"
  class="tw-fixed tw-inset-y-0 tw-left-0 tw-w-full tw-max-w-xs tw-bg-white tw-z-50 tw-transform tw--translate-x-full tw-transition-transform tw-duration-300 tw-ease-in-out tw-flex tw-flex-col"
  data-mobile-menu
  role="dialog"
  aria-modal="true"
  aria-label="{{ 'general.navigation.menu' | t | default: 'Menú de navegación' }}"
>
  {%- comment -%} Header del drawer {%- endcomment -%}
  <div class="tw-flex tw-items-center tw-justify-between tw-px-4 tw-py-4 tw-border-b tw-border-velox-100">
    <span class="tw-text-lg tw-font-semibold tw-text-velox-900">
      {{ 'general.navigation.menu' | t | default: 'Menú' }}
    </span>
    <button
      type="button"
      class="tw-p-2 tw--mr-2 tw-text-velox-500 hover:tw-text-velox-900 tw-transition-colors"
      data-mobile-menu-close
      aria-label="{{ 'general.accessibility.close' | t | default: 'Cerrar' }}"
    >
      {% render 'icon', name: 'x', class: 'tw-w-6 tw-h-6' %}
    </button>
  </div>

  {%- comment -%} Navegación {%- endcomment -%}
  <nav class="tw-flex-1 tw-overflow-y-auto tw-py-4">
    {% if menu != blank %}
      <ul class="tw-space-y-1">
        {% for link in linklists[menu].links %}
          <li>
            {% if link.links != blank %}
              {%- comment -%} Link con submenú (accordion) {%- endcomment -%}
              <div data-accordion>
                <button
                  type="button"
                  class="tw-w-full tw-flex tw-items-center tw-justify-between tw-px-4 tw-py-3 tw-text-base tw-font-medium tw-text-velox-900 hover:tw-bg-velox-50 tw-transition-colors"
                  data-accordion-trigger
                  aria-expanded="false"
                >
                  {{ link.title }}
                  {% render 'icon', name: 'chevron-down', class: 'tw-w-5 tw-h-5 tw-text-velox-400 tw-transition-transform' %}
                </button>

                <ul
                  class="tw-hidden tw-bg-velox-50"
                  data-accordion-content
                >
                  {% for child_link in link.links %}
                    <li>
                      <a
                        href="{{ child_link.url }}"
                        class="tw-block tw-px-8 tw-py-2.5 tw-text-sm tw-text-velox-700 hover:tw-text-velox-900 hover:tw-bg-velox-100 tw-transition-colors"
                      >
                        {{ child_link.title }}
                      </a>
                    </li>
                  {% endfor %}
                </ul>
              </div>
            {% else %}
              {%- comment -%} Link simple {%- endcomment -%}
              <a
                href="{{ link.url }}"
                class="tw-block tw-px-4 tw-py-3 tw-text-base tw-font-medium tw-text-velox-900 hover:tw-bg-velox-50 tw-transition-colors {% if link.active %}tw-text-accent{% endif %}"
              >
                {{ link.title }}
              </a>
            {% endif %}
          </li>
        {% endfor %}
      </ul>
    {% endif %}
  </nav>

  {%- comment -%} Footer del drawer {%- endcomment -%}
  <div class="tw-border-t tw-border-velox-100 tw-px-4 tw-py-4 tw-space-y-4">
    {%- comment -%} Account links {%- endcomment -%}
    {% if shop.customer_accounts_enabled %}
      <div class="tw-flex tw-items-center tw-gap-3">
        {% render 'icon', name: 'user', class: 'tw-w-5 tw-h-5 tw-text-velox-500' %}
        {% if customer %}
          <a href="{{ routes.account_url }}" class="tw-text-sm tw-font-medium tw-text-velox-700 hover:tw-text-velox-900">
            {{ 'customer.account.title' | t | default: 'Mi cuenta' }}
          </a>
        {% else %}
          <a href="{{ routes.account_login_url }}" class="tw-text-sm tw-font-medium tw-text-velox-700 hover:tw-text-velox-900">
            {{ 'customer.login.title' | t | default: 'Iniciar sesión' }}
          </a>
        {% endif %}
      </div>
    {% endif %}

    {%- comment -%} Currency/Language selector placeholder {%- endcomment -%}
    {% if localization.available_countries.size > 1 or localization.available_languages.size > 1 %}
      <div class="tw-pt-4 tw-border-t tw-border-velox-100">
        {% if localization.available_languages.size > 1 %}
          <div class="tw-mb-3">
            <label class="tw-block tw-text-xs tw-text-velox-500 tw-mb-1">
              {{ 'general.language.label' | t | default: 'Idioma' }}
            </label>
            <span class="tw-text-sm tw-font-medium tw-text-velox-900">
              {{ localization.language.endonym_name }}
            </span>
          </div>
        {% endif %}

        {% if localization.available_countries.size > 1 %}
          <div>
            <label class="tw-block tw-text-xs tw-text-velox-500 tw-mb-1">
              {{ 'general.currency.label' | t | default: 'País/Moneda' }}
            </label>
            <span class="tw-text-sm tw-font-medium tw-text-velox-900">
              {{ localization.country.name }} ({{ localization.country.currency.iso_code }} {{ localization.country.currency.symbol }})
            </span>
          </div>
        {% endif %}
      </div>
    {% endif %}
  </div>
</div>
