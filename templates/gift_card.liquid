{% layout none %}
{%- comment -%}
  Página de tarjeta regalo - Velox Theme
  Esta página es standalone y puede ser impresa o compartida
{%- endcomment -%}

<!doctype html>
<html lang="{{ request.locale.iso_code }}" class="velox-gift-card-html">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="{{ settings.color_accent }}">

    <title>{{ 'gift_card.card' | t }} - {{ shop.name }}</title>

    {%- comment -%} CSS Variables del tema {%- endcomment -%}
    {% render 'css-variables' %}

    {%- comment -%} CSS crítico {%- endcomment -%}
    {{ 'critical.css' | asset_url | stylesheet_tag: preload: true }}

    {%- comment -%} Meta tags {%- endcomment -%}
    {% render 'meta-tags' %}

    {% style %}
      /* === Gift Card Page Styles === */

      .velox-gift-card-html {
        height: 100%;
      }

      .velox-gift-card-body {
        min-height: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 2rem 1rem;
        background: linear-gradient(135deg, var(--color-background) 0%, var(--color-secondary) 100%);
        font-family: var(--font-primary--family);
      }

      .velox-gift-card {
        width: 100%;
        max-width: 28rem;
        text-align: center;
      }

      /* Logo */
      .velox-gift-card__logo {
        margin-bottom: 2rem;
      }

      .velox-gift-card__logo-img {
        height: 2.5rem;
        width: auto;
        margin: 0 auto;
      }

      .velox-gift-card__logo-text {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--color-foreground);
        font-family: var(--font-heading--family);
      }

      /* Card visual */
      .velox-gift-card__card {
        position: relative;
        background: linear-gradient(135deg, var(--color-accent) 0%, color-mix(in srgb, var(--color-accent) 70%, black) 100%);
        border-radius: 1rem;
        padding: 2rem;
        margin-bottom: 2rem;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        overflow: hidden;
      }

      .velox-gift-card__card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        opacity: 0.5;
      }

      .velox-gift-card__card-content {
        position: relative;
        z-index: 1;
      }

      .velox-gift-card__image {
        width: 6rem;
        height: 6rem;
        margin: 0 auto 1.5rem;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.2);
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .velox-gift-card__image img {
        width: 4rem;
        height: 4rem;
        object-fit: contain;
      }

      .velox-gift-card__image svg {
        width: 3rem;
        height: 3rem;
        color: white;
      }

      .velox-gift-card__shop-name {
        font-size: 0.875rem;
        font-weight: 500;
        color: rgba(255, 255, 255, 0.8);
        text-transform: uppercase;
        letter-spacing: 0.1em;
        margin-bottom: 0.5rem;
      }

      .velox-gift-card__balance {
        font-size: 2.5rem;
        font-weight: 700;
        color: white;
        font-family: var(--font-heading--family);
        line-height: 1.2;
      }

      /* Status badges */
      .velox-gift-card__status {
        display: inline-flex;
        align-items: center;
        gap: 0.375rem;
        padding: 0.375rem 0.75rem;
        border-radius: 9999px;
        font-size: 0.75rem;
        font-weight: 600;
        margin-top: 1rem;
      }

      .velox-gift-card__status--expired {
        background: rgba(239, 68, 68, 0.2);
        color: #fca5a5;
      }

      .velox-gift-card__status--active {
        background: rgba(34, 197, 94, 0.2);
        color: #86efac;
      }

      .velox-gift-card__status svg {
        width: 0.875rem;
        height: 0.875rem;
      }

      /* Code section */
      .velox-gift-card__code-section {
        background: var(--color-background);
        border-radius: 0.75rem;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
        border: 1px solid var(--color-border, rgba(0,0,0,0.1));
      }

      .velox-gift-card__code-label {
        font-size: 0.75rem;
        font-weight: 500;
        color: var(--color-foreground-muted, #6b7280);
        text-transform: uppercase;
        letter-spacing: 0.05em;
        margin-bottom: 0.75rem;
      }

      .velox-gift-card__code {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.75rem;
        flex-wrap: wrap;
      }

      .velox-gift-card__code-value {
        font-size: 1.25rem;
        font-weight: 600;
        font-family: ui-monospace, SFMono-Regular, "SF Mono", Menlo, Consolas, monospace;
        color: var(--color-foreground);
        letter-spacing: 0.1em;
        word-break: break-all;
      }

      .velox-gift-card__copy-btn {
        display: inline-flex;
        align-items: center;
        gap: 0.375rem;
        padding: 0.5rem 0.75rem;
        font-size: 0.75rem;
        font-weight: 500;
        color: var(--color-accent);
        background: color-mix(in srgb, var(--color-accent) 10%, transparent);
        border: none;
        border-radius: 0.375rem;
        cursor: pointer;
        transition: background-color 0.2s;
      }

      .velox-gift-card__copy-btn:hover {
        background: color-mix(in srgb, var(--color-accent) 20%, transparent);
      }

      .velox-gift-card__copy-btn svg {
        width: 1rem;
        height: 1rem;
      }

      .velox-gift-card__copy-btn--success {
        color: #22c55e;
        background: rgba(34, 197, 94, 0.1);
      }

      /* QR Code */
      .velox-gift-card__qr {
        display: flex;
        justify-content: center;
        margin-bottom: 1.5rem;
      }

      .velox-gift-card__qr img {
        width: 8rem;
        height: 8rem;
        border-radius: 0.5rem;
        background: white;
        padding: 0.5rem;
      }

      /* Info */
      .velox-gift-card__info {
        font-size: 0.875rem;
        color: var(--color-foreground-muted, #6b7280);
        margin-bottom: 1.5rem;
      }

      .velox-gift-card__info p {
        margin: 0.25rem 0;
      }

      /* Apple Wallet */
      .velox-gift-card__wallet {
        margin-bottom: 1.5rem;
      }

      .velox-gift-card__wallet-link {
        display: inline-block;
        transition: transform 0.2s;
      }

      .velox-gift-card__wallet-link:hover {
        transform: scale(1.02);
      }

      .velox-gift-card__wallet-link img {
        height: 2.75rem;
        width: auto;
      }

      /* Actions */
      .velox-gift-card__actions {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
      }

      .velox-gift-card__btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        padding: 0.75rem 1.5rem;
        font-size: 0.875rem;
        font-weight: 600;
        text-decoration: none;
        border-radius: 0.5rem;
        transition: all 0.2s;
        cursor: pointer;
        border: none;
      }

      .velox-gift-card__btn--primary {
        background: var(--color-accent);
        color: white;
      }

      .velox-gift-card__btn--primary:hover {
        background: color-mix(in srgb, var(--color-accent) 90%, black);
      }

      .velox-gift-card__btn--secondary {
        background: transparent;
        color: var(--color-foreground);
        border: 1px solid var(--color-border, rgba(0,0,0,0.2));
      }

      .velox-gift-card__btn--secondary:hover {
        background: var(--color-secondary);
      }

      .velox-gift-card__btn svg {
        width: 1.25rem;
        height: 1.25rem;
      }

      /* Print styles */
      @media print {
        .velox-gift-card-body {
          background: white;
          padding: 0;
        }

        .velox-gift-card__actions,
        .velox-gift-card__wallet {
          display: none;
        }

        .velox-gift-card__card {
          box-shadow: none;
          print-color-adjust: exact;
          -webkit-print-color-adjust: exact;
        }
      }

      /* Responsive */
      @media (min-width: 640px) {
        .velox-gift-card-body {
          padding: 3rem 1.5rem;
        }

        .velox-gift-card__balance {
          font-size: 3rem;
        }

        .velox-gift-card__code-value {
          font-size: 1.5rem;
        }

        .velox-gift-card__actions {
          flex-direction: row;
          justify-content: center;
        }
      }
    {% endstyle %}

    {{ content_for_header }}
  </head>

  <body class="velox-gift-card-body">
    <main class="velox-gift-card">
      {%- comment -%} Logo {%- endcomment -%}
      <div class="velox-gift-card__logo">
        {%- if settings.logo -%}
          {{ settings.logo | image_url: width: 200 | image_tag: class: 'velox-gift-card__logo-img', alt: shop.name }}
        {%- else -%}
          <span class="velox-gift-card__logo-text">{{ shop.name }}</span>
        {%- endif -%}
      </div>

      {%- comment -%} Card visual {%- endcomment -%}
      <div class="velox-gift-card__card">
        <div class="velox-gift-card__card-content">
          {%- comment -%} Gift icon {%- endcomment -%}
          <div class="velox-gift-card__image">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M21 11.25v8.25a1.5 1.5 0 0 1-1.5 1.5H5.25a1.5 1.5 0 0 1-1.5-1.5v-8.25M12 4.875A2.625 2.625 0 1 0 9.375 7.5H12m0-2.625V7.5m0-2.625A2.625 2.625 0 1 1 14.625 7.5H12m0 0V21m-8.625-9.75h18c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125h-18c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z" />
            </svg>
          </div>

          {%- comment -%} Shop name {%- endcomment -%}
          <p class="velox-gift-card__shop-name">{{ shop.name }}</p>

          {%- comment -%} Balance {%- endcomment -%}
          <p class="velox-gift-card__balance">{{ gift_card.balance | money }}</p>

          {%- comment -%} Status badge {%- endcomment -%}
          {%- if gift_card.enabled == false or gift_card.expired -%}
            <span class="velox-gift-card__status velox-gift-card__status--expired">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22z" clip-rule="evenodd" />
              </svg>
              {{ 'gift_card.expired' | t }}
            </span>
          {%- else -%}
            <span class="velox-gift-card__status velox-gift-card__status--active">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z" clip-rule="evenodd" />
              </svg>
              {{ 'gift_card.active' | t }}
            </span>
          {%- endif -%}
        </div>
      </div>

      {%- comment -%} Code section {%- endcomment -%}
      <div class="velox-gift-card__code-section">
        <p class="velox-gift-card__code-label">{{ 'gift_card.code_label' | t }}</p>
        <div class="velox-gift-card__code">
          <span class="velox-gift-card__code-value" id="gift-card-code">{{ gift_card.code | format_code }}</span>
          <button
            type="button"
            class="velox-gift-card__copy-btn"
            id="copy-code-btn"
            data-code="{{ gift_card.code }}"
            aria-label="{{ 'gift_card.copy_code' | t }}"
          >
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" id="copy-icon">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184" />
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" id="check-icon" style="display: none;">
              <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5" />
            </svg>
            <span id="copy-text">{{ 'gift_card.copy_code' | t }}</span>
          </button>
        </div>
      </div>

      {%- comment -%} QR Code {%- endcomment -%}
      {%- if gift_card.qr_code -%}
        <div class="velox-gift-card__qr">
          <img src="{{ gift_card.qr_code }}" alt="{{ 'gift_card.qr_code_alt' | t }}">
        </div>
      {%- endif -%}

      {%- comment -%} Info {%- endcomment -%}
      <div class="velox-gift-card__info">
        <p>{{ 'gift_card.use_at_checkout' | t }}</p>
        {%- if gift_card.expires_on -%}
          {%- assign expires_on = gift_card.expires_on | date: format: 'date' -%}
          <p>{{ 'gift_card.expires_on' | t: expires_on: expires_on }}</p>
        {%- endif -%}
      </div>

      {%- comment -%} Apple Wallet {%- endcomment -%}
      {%- if gift_card.pass_url -%}
        <div class="velox-gift-card__wallet">
          <a href="{{ gift_card.pass_url }}" class="velox-gift-card__wallet-link" aria-label="{{ 'gift_card.add_to_apple_wallet' | t }}">
            <img
              src="{{ 'gift-card/add-to-apple-wallet.svg' | shopify_asset_url }}"
              alt="{{ 'gift_card.add_to_apple_wallet' | t }}"
              width="156"
              height="40"
            >
          </a>
        </div>
      {%- endif -%}

      {%- comment -%} Actions {%- endcomment -%}
      <div class="velox-gift-card__actions">
        <a href="{{ shop.url }}" class="velox-gift-card__btn velox-gift-card__btn--primary">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 10.5V6a3.75 3.75 0 1 0-7.5 0v4.5m11.356-1.993 1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 0 1-1.12-1.243l1.264-12A1.125 1.125 0 0 1 5.513 7.5h12.974c.576 0 1.059.435 1.119 1.007ZM8.625 10.5a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm7.5 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z" />
          </svg>
          {{ 'gift_card.start_shopping' | t }}
        </a>
        <button type="button" class="velox-gift-card__btn velox-gift-card__btn--secondary" onclick="window.print()">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6.72 13.829c-.24.03-.48.062-.72.096m.72-.096a42.415 42.415 0 0 1 10.56 0m-10.56 0L6.34 18m10.94-4.171c.24.03.48.062.72.096m-.72-.096L17.66 18m0 0 .229 2.523a1.125 1.125 0 0 1-1.12 1.227H7.231c-.662 0-1.18-.568-1.12-1.227L6.34 18m11.318 0h1.091A2.25 2.25 0 0 0 21 15.75V9.456c0-1.081-.768-2.015-1.837-2.175a48.055 48.055 0 0 0-1.913-.247M6.34 18H5.25A2.25 2.25 0 0 1 3 15.75V9.456c0-1.081.768-2.015 1.837-2.175a48.041 48.041 0 0 1 1.913-.247m10.5 0a48.536 48.536 0 0 0-10.5 0m10.5 0V3.375c0-.621-.504-1.125-1.125-1.125h-8.25c-.621 0-1.125.504-1.125 1.125v3.659M18 10.5h.008v.008H18V10.5Zm-3 0h.008v.008H15V10.5Z" />
          </svg>
          {{ 'gift_card.print' | t }}
        </button>
      </div>
    </main>

    <script>
      // Copy code functionality
      document.getElementById('copy-code-btn').addEventListener('click', function() {
        const code = this.dataset.code;
        const copyIcon = document.getElementById('copy-icon');
        const checkIcon = document.getElementById('check-icon');
        const copyText = document.getElementById('copy-text');
        const btn = this;

        navigator.clipboard.writeText(code).then(function() {
          // Show success state
          copyIcon.style.display = 'none';
          checkIcon.style.display = 'block';
          copyText.textContent = '{{ 'gift_card.copied' | t }}';
          btn.classList.add('velox-gift-card__copy-btn--success');

          // Reset after 2 seconds
          setTimeout(function() {
            copyIcon.style.display = 'block';
            checkIcon.style.display = 'none';
            copyText.textContent = '{{ 'gift_card.copy_code' | t }}';
            btn.classList.remove('velox-gift-card__copy-btn--success');
          }, 2000);
        }).catch(function() {
          // Fallback for older browsers
          const textArea = document.createElement('textarea');
          textArea.value = code;
          document.body.appendChild(textArea);
          textArea.select();
          document.execCommand('copy');
          document.body.removeChild(textArea);

          copyText.textContent = '{{ 'gift_card.copied' | t }}';
          setTimeout(function() {
            copyText.textContent = '{{ 'gift_card.copy_code' | t }}';
          }, 2000);
        });
      });
    </script>
  </body>
</html>
