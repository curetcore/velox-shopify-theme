{% comment %}
  Velox Theme - Customer Order Detail Page
  Fase 8: Cuenta de cliente
  Adaptado de Tailwind Plus: ecommerce/order-summaries/simple-with-full-order-details

  Features:
  - Detalle completo del pedido
  - Lista de productos con imágenes
  - Resumen de precios (subtotal, envío, impuestos, total)
  - Dirección de envío
  - Estado del pedido
  - Soporte dark mode
{% endcomment %}

{% style %}
  /* ========== ORDER BASE STYLES ========== */
  .velox-order {
    background-color: #ffffff;
    min-height: 100vh;
  }

  .velox-order--dark {
    background-color: #111827;
  }

  .velox-order__wrapper {
    display: grid;
    grid-template-columns: 1fr;
  }

  /* ========== HERO IMAGE ========== */
  .velox-order__hero {
    height: 20rem;
    overflow: hidden;
  }

  .velox-order__hero img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  /* ========== CONTENT ========== */
  .velox-order__content {
    max-width: 42rem;
    margin: 0 auto;
    padding: 2rem 1rem;
  }

  /* ========== HEADER ========== */
  .velox-order__header {
    margin-bottom: 2rem;
  }

  .velox-order__back {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.875rem;
    color: var(--color-accent, #4f46e5);
    text-decoration: none;
    margin-bottom: 1.5rem;
  }

  .velox-order__back:hover {
    text-decoration: underline;
  }

  .velox-order__back svg {
    width: 1rem;
    height: 1rem;
  }

  .velox-order__status-badge {
    display: inline-block;
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--color-accent, #4f46e5);
    margin-bottom: 0.5rem;
  }

  .velox-order--dark .velox-order__status-badge {
    color: #818cf8;
  }

  .velox-order__title {
    font-size: 1.5rem;
    font-weight: 700;
    color: #111827;
    margin: 0 0 0.5rem 0;
    line-height: 1.2;
  }

  .velox-order--dark .velox-order__title {
    color: #ffffff;
  }

  .velox-order__subtitle {
    font-size: 1rem;
    color: #6b7280;
    margin: 0;
  }

  .velox-order--dark .velox-order__subtitle {
    color: #9ca3af;
  }

  /* ========== ORDER INFO ========== */
  .velox-order__info {
    margin-top: 2rem;
  }

  .velox-order__info-label {
    font-size: 0.875rem;
    font-weight: 500;
    color: #111827;
    margin: 0;
  }

  .velox-order--dark .velox-order__info-label {
    color: #f3f4f6;
  }

  .velox-order__info-value {
    font-size: 0.875rem;
    color: var(--color-accent, #4f46e5);
    margin: 0.5rem 0 0 0;
  }

  /* ========== PRODUCT LIST ========== */
  .velox-order__products {
    list-style: none;
    margin: 1.5rem 0 0 0;
    padding: 0;
    border-top: 1px solid #e5e7eb;
  }

  .velox-order--dark .velox-order__products {
    border-color: #374151;
  }

  .velox-order__product {
    display: flex;
    gap: 1.5rem;
    padding: 1.5rem 0;
    border-bottom: 1px solid #e5e7eb;
  }

  .velox-order--dark .velox-order__product {
    border-color: #374151;
  }

  .velox-order__product-image {
    width: 6rem;
    height: 6rem;
    flex-shrink: 0;
    border-radius: 0.5rem;
    overflow: hidden;
    background-color: #f3f4f6;
  }

  .velox-order__product-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .velox-order__product-details {
    flex: 1;
    min-width: 0;
  }

  .velox-order__product-title {
    font-size: 0.875rem;
    font-weight: 500;
    color: #111827;
    margin: 0;
  }

  .velox-order__product-title a {
    color: inherit;
    text-decoration: none;
  }

  .velox-order__product-title a:hover {
    color: var(--color-accent, #4f46e5);
  }

  .velox-order--dark .velox-order__product-title {
    color: #f3f4f6;
  }

  .velox-order__product-meta {
    font-size: 0.875rem;
    color: #6b7280;
    margin: 0.25rem 0 0 0;
  }

  .velox-order--dark .velox-order__product-meta {
    color: #9ca3af;
  }

  .velox-order__product-price {
    font-size: 0.875rem;
    font-weight: 500;
    color: #111827;
    white-space: nowrap;
  }

  .velox-order--dark .velox-order__product-price {
    color: #f3f4f6;
  }

  /* ========== SUMMARY ========== */
  .velox-order__summary {
    border-top: 1px solid #e5e7eb;
    padding-top: 1.5rem;
    margin-top: 0;
  }

  .velox-order--dark .velox-order__summary {
    border-color: #374151;
  }

  .velox-order__summary-row {
    display: flex;
    justify-content: space-between;
    font-size: 0.875rem;
    color: #6b7280;
    margin-bottom: 1rem;
  }

  .velox-order--dark .velox-order__summary-row {
    color: #9ca3af;
  }

  .velox-order__summary-row dd {
    font-weight: 500;
    color: #111827;
    margin: 0;
  }

  .velox-order--dark .velox-order__summary-row dd {
    color: #f3f4f6;
  }

  .velox-order__summary-row dt {
    margin: 0;
  }

  .velox-order__summary-total {
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-top: 1px solid #e5e7eb;
    padding-top: 1.5rem;
    margin-top: 0.5rem;
  }

  .velox-order--dark .velox-order__summary-total {
    border-color: #374151;
  }

  .velox-order__summary-total dt {
    font-size: 1rem;
    font-weight: 500;
    color: #111827;
    margin: 0;
  }

  .velox-order--dark .velox-order__summary-total dt {
    color: #f3f4f6;
  }

  .velox-order__summary-total dd {
    font-size: 1rem;
    font-weight: 500;
    color: #111827;
    margin: 0;
  }

  .velox-order--dark .velox-order__summary-total dd {
    color: #f3f4f6;
  }

  /* ========== ADDRESS SECTION ========== */
  .velox-order__addresses {
    display: grid;
    grid-template-columns: 1fr;
    gap: 2rem;
    margin-top: 2rem;
    padding-top: 2rem;
    border-top: 1px solid #e5e7eb;
  }

  .velox-order--dark .velox-order__addresses {
    border-color: #374151;
  }

  .velox-order__address-title {
    font-size: 0.875rem;
    font-weight: 500;
    color: #111827;
    margin: 0 0 0.5rem 0;
  }

  .velox-order--dark .velox-order__address-title {
    color: #f3f4f6;
  }

  .velox-order__address {
    font-size: 0.875rem;
    font-style: normal;
    color: #6b7280;
    line-height: 1.6;
  }

  .velox-order--dark .velox-order__address {
    color: #9ca3af;
  }

  .velox-order__address span {
    display: block;
  }

  /* ========== FOOTER ========== */
  .velox-order__footer {
    margin-top: 2rem;
    padding-top: 1.5rem;
    border-top: 1px solid #e5e7eb;
    text-align: right;
  }

  .velox-order--dark .velox-order__footer {
    border-color: #374151;
  }

  .velox-order__continue {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--color-accent, #4f46e5);
    text-decoration: none;
  }

  .velox-order__continue:hover {
    text-decoration: underline;
  }

  /* ========== RESPONSIVE ========== */
  @media (min-width: 640px) {
    .velox-order__content {
      padding: 4rem 1.5rem;
    }

    .velox-order__title {
      font-size: 2.25rem;
    }

    .velox-order__addresses {
      grid-template-columns: 1fr 1fr;
    }
  }

  @media (min-width: 1024px) {
    .velox-order__wrapper {
      grid-template-columns: 1fr 1fr;
    }

    .velox-order__hero {
      position: absolute;
      left: 0;
      top: 0;
      width: 50%;
      height: 100%;
    }

    .velox-order__content {
      grid-column: 2;
      padding: 4rem 2rem;
    }
  }
{% endstyle %}

<div class="velox-order{% if section.settings.color_scheme == 'dark' %} velox-order--dark{% endif %}">
  <div class="velox-order__wrapper">

    {%- comment -%} Hero image (opcional) {%- endcomment -%}
    {% if section.settings.show_hero_image and section.settings.hero_image %}
      <div class="velox-order__hero">
        {{ section.settings.hero_image | image_url: width: 1200 | image_tag: alt: '' }}
      </div>
    {% endif %}

    {%- comment -%} Content {%- endcomment -%}
    <div class="velox-order__content">

      {%- comment -%} Back link {%- endcomment -%}
      <a href="{{ routes.account_url }}" class="velox-order__back">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18" />
        </svg>
        {{ 'customer.orders.back_to_account' | t | default: 'Back to account' }}
      </a>

      {%- comment -%} Header {%- endcomment -%}
      <div class="velox-order__header">
        <p class="velox-order__status-badge">
          {% if order.fulfillment_status == 'fulfilled' %}
            {{ 'customer.orders.fulfilled' | t | default: 'Delivered' }}
          {% elsif order.fulfillment_status == 'partial' %}
            {{ 'customer.orders.partially_fulfilled' | t | default: 'Partially shipped' }}
          {% else %}
            {{ 'customer.orders.unfulfilled' | t | default: 'Processing' }}
          {% endif %}
        </p>
        <h1 class="velox-order__title">
          {{ 'customer.orders.order' | t | default: 'Order' }} {{ order.name }}
        </h1>
        <p class="velox-order__subtitle">
          {{ 'customer.orders.placed_on' | t | default: 'Placed on' }}
          <time datetime="{{ order.created_at | date: '%Y-%m-%d' }}">
            {{ order.created_at | date: format: 'date' }}
          </time>
        </p>
      </div>

      {%- comment -%} Tracking number si existe {%- endcomment -%}
      {% if order.fulfillments.size > 0 %}
        {% for fulfillment in order.fulfillments %}
          {% if fulfillment.tracking_number %}
            <dl class="velox-order__info">
              <dt class="velox-order__info-label">
                {{ 'customer.orders.tracking_number' | t | default: 'Tracking number' }}
              </dt>
              <dd class="velox-order__info-value">
                {% if fulfillment.tracking_url %}
                  <a href="{{ fulfillment.tracking_url }}" target="_blank" rel="noopener">
                    {{ fulfillment.tracking_number }}
                  </a>
                {% else %}
                  {{ fulfillment.tracking_number }}
                {% endif %}
              </dd>
            </dl>
          {% endif %}
        {% endfor %}
      {% endif %}

      {%- comment -%} Product list {%- endcomment -%}
      <ul class="velox-order__products" role="list">
        {% for line_item in order.line_items %}
          <li class="velox-order__product">
            <div class="velox-order__product-image">
              {% if line_item.image %}
                {{ line_item.image | image_url: width: 200 | image_tag: alt: line_item.title }}
              {% else %}
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 100%; height: 100%; padding: 1.5rem; color: #d1d5db;">
                  <path stroke-linecap="round" stroke-linejoin="round" d="m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z" />
                </svg>
              {% endif %}
            </div>
            <div class="velox-order__product-details">
              <h3 class="velox-order__product-title">
                {% if line_item.product.url %}
                  <a href="{{ line_item.product.url }}">{{ line_item.title }}</a>
                {% else %}
                  {{ line_item.title }}
                {% endif %}
              </h3>
              {% if line_item.variant.title != 'Default Title' %}
                <p class="velox-order__product-meta">{{ line_item.variant.title }}</p>
              {% endif %}
              <p class="velox-order__product-meta">
                {{ 'customer.orders.quantity' | t | default: 'Qty' }}: {{ line_item.quantity }}
              </p>
            </div>
            <p class="velox-order__product-price">{{ line_item.final_line_price | money }}</p>
          </li>
        {% endfor %}
      </ul>

      {%- comment -%} Order summary {%- endcomment -%}
      <dl class="velox-order__summary">
        <div class="velox-order__summary-row">
          <dt>{{ 'cart.general.subtotal' | t }}</dt>
          <dd>{{ order.line_items_subtotal_price | money }}</dd>
        </div>

        {% for discount in order.discounts %}
          <div class="velox-order__summary-row">
            <dt>{{ discount.code }}</dt>
            <dd>-{{ discount.savings | money }}</dd>
          </div>
        {% endfor %}

        {% for shipping_method in order.shipping_methods %}
          <div class="velox-order__summary-row">
            <dt>{{ 'customer.orders.shipping' | t | default: 'Shipping' }} ({{ shipping_method.title }})</dt>
            <dd>{{ shipping_method.price | money }}</dd>
          </div>
        {% endfor %}

        {% if order.tax_price > 0 %}
          <div class="velox-order__summary-row">
            <dt>{{ 'customer.orders.tax' | t | default: 'Tax' }}</dt>
            <dd>{{ order.tax_price | money }}</dd>
          </div>
        {% endif %}

        <div class="velox-order__summary-total">
          <dt>{{ 'customer.orders.total' | t | default: 'Total' }}</dt>
          <dd>{{ order.total_price | money }}</dd>
        </div>
      </dl>

      {%- comment -%} Addresses {%- endcomment -%}
      <div class="velox-order__addresses">
        {% if order.shipping_address %}
          <div>
            <h3 class="velox-order__address-title">
              {{ 'customer.orders.shipping_address' | t | default: 'Shipping address' }}
            </h3>
            <address class="velox-order__address">
              <span>{{ order.shipping_address.name }}</span>
              {% if order.shipping_address.company != blank %}
                <span>{{ order.shipping_address.company }}</span>
              {% endif %}
              <span>{{ order.shipping_address.address1 }}</span>
              {% if order.shipping_address.address2 != blank %}
                <span>{{ order.shipping_address.address2 }}</span>
              {% endif %}
              <span>{{ order.shipping_address.city }}, {{ order.shipping_address.province }} {{ order.shipping_address.zip }}</span>
              <span>{{ order.shipping_address.country }}</span>
              {% if order.shipping_address.phone != blank %}
                <span>{{ order.shipping_address.phone }}</span>
              {% endif %}
            </address>
          </div>
        {% endif %}

        {% if order.billing_address %}
          <div>
            <h3 class="velox-order__address-title">
              {{ 'customer.orders.billing_address' | t | default: 'Billing address' }}
            </h3>
            <address class="velox-order__address">
              <span>{{ order.billing_address.name }}</span>
              {% if order.billing_address.company != blank %}
                <span>{{ order.billing_address.company }}</span>
              {% endif %}
              <span>{{ order.billing_address.address1 }}</span>
              {% if order.billing_address.address2 != blank %}
                <span>{{ order.billing_address.address2 }}</span>
              {% endif %}
              <span>{{ order.billing_address.city }}, {{ order.billing_address.province }} {{ order.billing_address.zip }}</span>
              <span>{{ order.billing_address.country }}</span>
            </address>
          </div>
        {% endif %}
      </div>

      {%- comment -%} Footer {%- endcomment -%}
      <div class="velox-order__footer">
        <a href="{{ routes.all_products_collection_url }}" class="velox-order__continue">
          {{ 'customer.orders.continue_shopping' | t | default: 'Continue shopping' }}
          <span aria-hidden="true">&rarr;</span>
        </a>
      </div>

    </div>
  </div>
</div>

{% schema %}
{
  "name": "Customer order",
  "tag": "section",
  "class": "section-order",
  "settings": [
    {
      "type": "checkbox",
      "id": "show_hero_image",
      "label": "Show hero image",
      "default": false
    },
    {
      "type": "image_picker",
      "id": "hero_image",
      "label": "Hero image"
    },
    {
      "type": "select",
      "id": "color_scheme",
      "label": "Color scheme",
      "options": [
        {
          "value": "light",
          "label": "Light"
        },
        {
          "value": "dark",
          "label": "Dark"
        }
      ],
      "default": "light"
    }
  ]
}
{% endschema %}
